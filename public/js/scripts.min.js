$(document).ready(function(){
  //hero slider
  $('#js-hero').slick({
    arrows: false,
    //autoplay: true,
    dots: true,
    autoplaySpeed: 2000,
    asNavFor: '#js-hero-bg'
  });
  $('#js-hero-bg').slick({
    arrows: false,
    //autoplay: true,
    dots: false,
    asNavFor: '#js-hero',
    fade: true,
    autoplaySpeed: 2000
  });

  function rightFract(){
    particlesJS("particles-js-2", {
      "particles": {
        "number": {
          "value": 60,
          "density": {
            "enable": true,
            "value_area": 400
          }
        },
        "color": {
          "value": "#ffffff"
        },
        "shape": {
          "type": "circle",
          "stroke": {
            "width": 0,
            "color": "#000000"
          },
          "polygon": {
            "nb_sides": 5
          },
          "image": {
            "src": "",
            "width": 100,
            "height": 100
          }
        },
        "opacity": {
          "value": 1,
          "random": false,
          "anim": {
            "enable": false,
            "speed": 1,
            "opacity_min": 0.1,
            "sync": false
          }
        },
        "size": {
          "value": 4,
          "random": true,
          "anim": {
            "enable": false,
            "speed": 10,
            "size_min": 0.1,
            "sync": false
          }
        },
        "line_linked": {
          "enable": true,
          "distance": 150,
          "color": "#f194ff",
          "opacity": 0.7,
          "width": 2
        },
        "move": {
          "enable": true,
          "speed": 2,
          "direction": "none",
          "random": false,
          "straight": false,
          "out_mode": "out",
          "bounce": false,
          "attract": {
            "enable": false,
            "rotateX": 600,
            "rotateY": 1200
          }
        }
      },
      "interactivity": {
        "detect_on": "canvas",
        "events": {
          "onhover": {
            "enable": true,
            "mode": "grab"
          },
          "onclick": {
            "enable": true,
            "mode": "push"
          },
          "resize": true
        },
        "modes": {
          "grab": {
            "distance": 140,
            "line_linked": {
              "opacity": 1
            }
          },
          "bubble": {
            "distance": 400,
            "size": 40,
            "duration": 2,
            "opacity": 8,
            "speed": 3
          },
          "repulse": {
            "distance": 200,
            "duration": 0.4
          },
          "push": {
            "particles_nb": 4
          },
          "remove": {
            "particles_nb": 2
          }
        }
      },
      "retina_detect": true
    });
  }

  if(window.innerWidth > 1020){
    particlesJS("js-particles-js-left", {
      "particles": {
        "number": {
          "value": 60,
          "density": {
            "enable": true,
            "value_area": 400
          }
        },
        "color": {
          "value": "#ffffff"
        },
        "shape": {
          "type": "circle",
          "stroke": {
            "width": 0,
            "color": "#000000"
          },
          "polygon": {
            "nb_sides": 5
          },
          "image": {
            "src": "",
            "width": 100,
            "height": 100
          }
        },
        "opacity": {
          "value": 1,
          "random": false,
          "anim": {
            "enable": false,
            "speed": 1,
            "opacity_min": 0.1,
            "sync": false
          }
        },
        "size": {
          "value": 4,
          "random": true,
          "anim": {
            "enable": false,
            "speed": 10,
            "size_min": 0.1,
            "sync": false
          }
        },
        "line_linked": {
          "enable": true,
          "distance": 150,
          "color": "#fff",
          "opacity": .9,
          "width": 1
        },
        "move": {
          "enable": true,
          "speed": 2,
          "direction": "none",
          "random": false,
          "straight": false,
          "out_mode": "out",
          "bounce": false,
          "attract": {
            "enable": false,
            "rotateX": 600,
            "rotateY": 1200
          }
        }
      },
      "interactivity": {
        "detect_on": "canvas",
        "events": {
          "onhover": {
            "enable": true,
            "mode": "grab"
          },
          "onclick": {
            "enable": true,
            "mode": "push"
          },
          "resize": true
        },
        "modes": {
          "grab": {
            "distance": 140,
            "line_linked": {
              "opacity": 1
            }
          },
          "bubble": {
            "distance": 400,
            "size": 40,
            "duration": 2,
            "opacity": 8,
            "speed": 3
          },
          "repulse": {
            "distance": 200,
            "duration": 0.4
          },
          "push": {
            "particles_nb": 4
          },
          "remove": {
            "particles_nb": 2
          }
        }
      },
      "retina_detect": true
    });
    particlesJS("js-particles-js-right", {
      "particles": {
        "number": {
          "value": 60,
          "density": {
            "enable": true,
            "value_area": 400
          }
        },
        "color": {
          "value": "#ffffff"
        },
        "shape": {
          "type": "circle",
          "stroke": {
            "width": 0,
            "color": "#000000"
          },
          "polygon": {
            "nb_sides": 5
          },
          "image": {
            "src": "",
            "width": 100,
            "height": 100
          }
        },
        "opacity": {
          "value": 1,
          "random": false,
          "anim": {
            "enable": false,
            "speed": 1,
            "opacity_min": 0.1,
            "sync": false
          }
        },
        "size": {
          "value": 4,
          "random": true,
          "anim": {
            "enable": false,
            "speed": 10,
            "size_min": 0.1,
            "sync": false
          }
        },
        "line_linked": {
          "enable": true,
          "distance": 150,
          "color": "#fff",
          "opacity": 0.9,
          "width": 1
        },
        "move": {
          "enable": true,
          "speed": 2,
          "direction": "none",
          "random": false,
          "straight": false,
          "out_mode": "out",
          "bounce": false,
          "attract": {
            "enable": false,
            "rotateX": 600,
            "rotateY": 1200
          }
        }
      },
      "interactivity": {
        "detect_on": "canvas",
        "events": {
          "onhover": {
            "enable": true,
            "mode": "grab"
          },
          "onclick": {
            "enable": true,
            "mode": "push"
          },
          "resize": true
        },
        "modes": {
          "grab": {
            "distance": 140,
            "line_linked": {
              "opacity": 1
            }
          },
          "bubble": {
            "distance": 400,
            "size": 40,
            "duration": 2,
            "opacity": 8,
            "speed": 3
          },
          "repulse": {
            "distance": 200,
            "duration": 0.4
          },
          "push": {
            "particles_nb": 4
          },
          "remove": {
            "particles_nb": 2
          }
        }
      },
      "retina_detect": true
    });
  }
});

$(document).ready(function(){


  //scroll
  $('.js-scroll').click(function(e){
    e.preventDefault();
    let anchor = $(this).attr("href"),
        scroll_el = $(anchor);
    if ($(scroll_el).length != 0) {
      $('html, body').animate({ scrollTop: $(scroll_el).offset().top}, 250);
    }
  });

  //order btn
  $('.js-order-btn').on('click', function(){
    $('#js-popup .js-popup-title').text('Отправить заявку');
    $('#js-popup .js-hide-input').val('Заявка');
    $('#js-popup').fadeIn(250);
    $('body').addClass('no-scroll');
  });

  //callback btn
  $('.js-callback-btn').on('click', function(){
    $('#js-popup .js-popup-title').text('Связаться с нами');
    $('#js-popup .js-hide-input').val('Связаться с нами');
    $('#js-popup').fadeIn(250);
    $('body').addClass('no-scroll');
  });

  //close popup
  $('.js-close-popup').on('click', function(){
    $('.js-popup').fadeOut(250);
    $('body').removeClass('no-scroll');
  });

  //submit
  let valid = false;
  $(".js-tel").mask("+7 (999) 999-99-99", {
    placeholder: "+7 (___) ___-__-__" ,
    completed : function(){
      valid = true;
    }
  });
  $('.js-form-val').on('submit', function(e){
    e.preventDefault();
    let form = $(this),
        fields = $(form).find('.js-val');

    $.each($(fields), function(){
      if (!$.trim($(this).val())){
        $(this).addClass('error');
        valid = false;
      } else {
        $(this).removeClass('error');
      }
    });

    if (valid){
      $.ajax({
        url: "/send",
        type: "POST",
        response: "HTML",
        data: $(this).serialize(),
        success: function(data) {
          $('#js-popup').fadeOut(250);
          $('#js-confirm').fadeIn(250);
        },
        error: function() {
          console.log("Не возможно отправить");
        }
      });
    }
  });
  $('.js-val').on('keypress', function(){
    $(this).removeClass('error');
  });

  //fix header
  $(window).on('scroll', function(){
    if( $(window).scrollTop() >  ($('#js-hero').innerHeight() - 50)){
      $('#js-header-fix').addClass('fix');
    } else{
      $('#js-header-fix').removeClass('fix');
    }
  });

  //show all menu
  $('#js-short-menu').on('click', function(){
    $('#js-header-fix').toggleClass('open');
  });

  //close popup
  $('.js-mob-menu').on('click', function(){
    $('#js-mob-menu').toggleClass('show');
    $('body').toggleClass('no-scroll');
  });

  //js-show-more
  $('.js-show-more').on('click', function(){
    $('.decisions__hide.hided').eq(0).slideDown(250).removeClass('hided');
    if($('.decisions__hide.hided').length === 0){
      $(this).remove();
    }
  });

  let count_sliders = $('.hero-bg-slide').length;

  if(count_sliders == 1 || count_sliders > 5){
      $('.slick-dots').hide();
  }

});
